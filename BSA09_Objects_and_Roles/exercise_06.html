<svg width="1400" height="1000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .class-rect { fill: white; stroke: #333; stroke-width: 2; }
      .class-rect-new { fill: #f8fff9; stroke: #28a745; stroke-width: 2; }
      .class-title { fill: #e8e8e8; stroke: #333; stroke-width: 1; }
      .class-title-new { fill: #d4edda; stroke: #28a745; stroke-width: 1; }
      .title-text { font-family: Arial; font-size: 14px; font-weight: bold; text-anchor: middle; }
      .title-text-new { font-family: Arial; font-size: 14px; font-weight: bold; text-anchor: middle; fill: #155724; }
      .attr-text { font-family: Arial; font-size: 11px; }
      .pk-text { fill: #d63384; font-weight: bold; }
      .fk-text { fill: #0066cc; font-style: italic; }
      .connection { stroke: #333; stroke-width: 2; fill: none; }
      .connection-new { stroke: #28a745; stroke-width: 2; fill: none; }
      .connection-text { font-family: Arial; font-size: 10px; text-anchor: middle; fill: #333; }
      .connection-text-new { font-family: Arial; font-size: 10px; text-anchor: middle; fill: #28a745; font-weight: bold; }
      .multiplicity { font-family: Arial; font-size: 9px; fill: #666; font-weight: bold; }
      .multiplicity-new { font-family: Arial; font-size: 9px; fill: #28a745; font-weight: bold; }
      .diagram-title { font-family: Arial; font-size: 18px; font-weight: bold; text-anchor: middle; fill: #333; }
    </style>
  </defs>
  
  <!-- Заголовок -->
  <text x="700" y="30" class="diagram-title">Актуализированная диаграмма классов UML - Система записи в барбершоп</text>
  
  <!-- Класс Персоны -->
  <g id="persons">
    <rect x="50" y="60" width="220" height="140" class="class-rect"/>
    <rect x="50" y="60" width="220" height="25" class="class-title"/>
    <text x="160" y="78" class="title-text">Персоны</text>
    <text x="60" y="100" class="attr-text pk-text">+ person_id: INTEGER</text>
    <text x="60" y="115" class="attr-text">+ login: VARCHAR(50)</text>
    <text x="60" y="130" class="attr-text">+ password: VARCHAR(255)</text>
    <text x="60" y="145" class="attr-text">+ first_name: VARCHAR(100)</text>
    <text x="60" y="160" class="attr-text">+ middle_name: VARCHAR(100)</text>
    <text x="60" y="175" class="attr-text">+ phone_number: VARCHAR(20)</text>
    <text x="60" y="190" class="attr-text">+ registration_date: DATETIME</text>
  </g>
  
  <!-- Класс Клиенты -->
  <g id="clients">
    <rect x="50" y="250" width="220" height="80" class="class-rect"/>
    <rect x="50" y="250" width="220" height="25" class="class-title"/>
    <text x="160" y="268" class="title-text">Клиенты</text>
    <text x="60" y="290" class="attr-text pk-text">+ client_id: INTEGER</text>
    <text x="60" y="305" class="attr-text fk-text">+ person_id: INTEGER</text>
    <text x="60" y="320" class="attr-text">+ registration_date: DATETIME</text>
  </g>
  
  <!-- Класс Сотрудники -->
  <g id="employees">
    <rect x="350" y="250" width="220" height="80" class="class-rect"/>
    <rect x="350" y="250" width="220" height="25" class="class-title"/>
    <text x="460" y="268" class="title-text">Сотрудники</text>
    <text x="360" y="290" class="attr-text pk-text">+ employee_id: INTEGER</text>
    <text x="360" y="305" class="attr-text fk-text">+ person_id: INTEGER</text>
    <text x="360" y="320" class="attr-text">+ hire_date: DATETIME</text>
  </g>
  
  <!-- Класс Роли сотрудника -->
  <g id="roles">
    <rect x="650" y="250" width="220" height="80" class="class-rect"/>
    <rect x="650" y="250" width="220" height="25" class="class-title"/>
    <text x="760" y="268" class="title-text">Роли сотрудника</text>
    <text x="660" y="290" class="attr-text pk-text">+ role_id: INTEGER</text>
    <text x="660" y="305" class="attr-text fk-text">+ employee_id: INTEGER</text>
    <text x="660" y="320" class="attr-text">+ role_name: ENUM</text>
  </g>
  
  <!-- Класс Услуги мастера -->
  <g id="master-services">
    <rect x="350" y="400" width="220" height="80" class="class-rect"/>
    <rect x="350" y="400" width="220" height="25" class="class-title"/>
    <text x="460" y="418" class="title-text">Услуги мастера</text>
    <text x="360" y="440" class="attr-text pk-text">+ master_service_id: INTEGER</text>
    <text x="360" y="455" class="attr-text fk-text">+ employee_id: INTEGER</text>
    <text x="360" y="470" class="attr-text fk-text">+ service_id: INTEGER</text>
  </g>
  
  <!-- Класс Услуги -->
  <g id="services">
    <rect x="650" y="400" width="220" height="65" class="class-rect"/>
    <rect x="650" y="400" width="220" height="25" class="class-title"/>
    <text x="760" y="418" class="title-text">Услуги</text>
    <text x="660" y="440" class="attr-text pk-text">+ service_id: INTEGER</text>
    <text x="660" y="455" class="attr-text">+ service_name: VARCHAR(200)</text>
  </g>
  
  <!-- Класс Слоты обслуживания -->
  <g id="slots">
    <rect x="50" y="550" width="220" height="180" class="class-rect"/>
    <rect x="50" y="550" width="220" height="25" class="class-title"/>
    <text x="160" y="568" class="title-text">Слоты обслуживания</text>
    <text x="60" y="590" class="attr-text pk-text">+ slot_id: INTEGER</text>
    <text x="60" y="605" class="attr-text">+ slot_date: DATE</text>
    <text x="60" y="620" class="attr-text">+ start_time: TIME</text>
    <text x="60" y="635" class="attr-text fk-text">+ master_id: INTEGER</text>
    <text x="60" y="650" class="attr-text fk-text">+ client_id: INTEGER</text>
    <text x="60" y="665" class="attr-text fk-text">+ service_id: INTEGER</text>
    <text x="60" y="680" class="attr-text">+ status: ENUM</text>
    <text x="60" y="695" class="attr-text">+ created_at: DATETIME</text>
    <text x="60" y="710" class="attr-text">+ updated_at: DATETIME</text>
  </g>
  
  <!-- НОВЫЕ КЛАССЫ -->
  <!-- Класс Скидки клиенту -->
  <g id="discounts">
    <rect x="50" y="780" width="220" height="180" class="class-rect-new"/>
    <rect x="50" y="780" width="220" height="25" class="class-title-new"/>
    <text x="160" y="798" class="title-text-new">Скидки клиенту</text>
    <text x="60" y="820" class="attr-text pk-text">+ discount_id: INTEGER</text>
    <text x="60" y="835" class="attr-text fk-text">+ client_id: INTEGER</text>
    <text x="60" y="850" class="attr-text">+ discount_type: ENUM</text>
    <text x="60" y="865" class="attr-text">+ discount_value: DECIMAL(5,2)</text>
    <text x="60" y="880" class="attr-text">+ min_order_amount: DECIMAL(8,2)</text>
    <text x="60" y="895" class="attr-text">+ valid_from: DATE</text>
    <text x="60" y="910" class="attr-text">+ valid_until: DATE</text>
    <text x="60" y="925" class="attr-text">+ usage_count: INTEGER</text>
    <text x="60" y="940" class="attr-text">+ max_usage: INTEGER</text>
    <text x="60" y="955" class="attr-text">+ is_active: BOOLEAN</text>
  </g>
  
  <!-- Класс Извещение клиента -->
  <g id="notifications">
    <rect x="950" y="550" width="220" height="180" class="class-rect-new"/>
    <rect x="950" y="550" width="220" height="25" class="class-title-new"/>
    <text x="1060" y="568" class="title-text-new">Извещение клиента</text>
    <text x="960" y="590" class="attr-text pk-text">+ notification_id: INTEGER</text>
    <text x="960" y="605" class="attr-text fk-text">+ client_id: INTEGER</text>
    <text x="960" y="620" class="attr-text fk-text">+ slot_id: INTEGER</text>
    <text x="960" y="635" class="attr-text">+ notification_type: ENUM</text>
    <text x="960" y="650" class="attr-text">+ channel: ENUM</text>
    <text x="960" y="665" class="attr-text">+ message_text: TEXT</text>
    <text x="960" y="680" class="attr-text">+ scheduled_time: DATETIME</text>
    <text x="960" y="695" class="attr-text">+ sent_time: DATETIME</text>
    <text x="960" y="710" class="attr-text">+ delivery_status: ENUM</text>
    <text x="960" y="725" class="attr-text">+ error_message: VARCHAR(500)</text>
  </g>
  
  <!-- СУЩЕСТВУЮЩИЕ СВЯЗИ -->
  <!-- Персоны -> Клиенты -->
  <line x1="160" y1="200" x2="160" y2="250" class="connection"/>
  <text x="175" y="225" class="connection-text">наследует</text>
  <text x="140" y="210" class="multiplicity">1</text>
  <text x="140" y="245" class="multiplicity">1</text>
  
  <!-- Персоны -> Сотрудники -->
  <line x1="270" y1="130" x2="350" y2="290" class="connection"/>
  <text x="320" y="210" class="connection-text">наследует</text>
  <text x="275" y="140" class="multiplicity">1</text>
  <text x="340" y="285" class="multiplicity">1</text>
  
  <!-- Сотрудники -> Роли сотрудника -->
  <line x1="570" y1="290" x2="650" y2="290" class="connection"/>
  <text x="610" y="285" class="connection-text">имеет роль</text>
  <text x="575" y="285" class="multiplicity">1</text>
  <text x="640" y="285" class="multiplicity">*</text>
  
  <!-- Сотрудники -> Услуги мастера -->
  <line x1="460" y1="330" x2="460" y2="400" class="connection"/>
  <text x="475" y="365" class="connection-text">оказывает</text>
  <text x="440" y="335" class="multiplicity">1</text>
  <text x="440" y="395" class="multiplicity">*</text>
  
  <!-- Услуги -> Услуги мастера -->
  <line x1="650" y1="440" x2="570" y2="440" class="connection"/>
  <text x="610" y="435" class="connection-text">предоставляет</text>
  <text x="640" y="435" class="multiplicity">1</text>
  <text x="575" y="435" class="multiplicity">*</text>
  
  <!-- Клиенты -> Слоты обслуживания -->
  <line x1="160" y1="330" x2="160" y2="550" class="connection"/>
  <text x="175" y="440" class="connection-text">записывается</text>
  <text x="140" y="335" class="multiplicity">1</text>
  <text x="140" y="545" class="multiplicity">*</text>
  
  <!-- Сотрудники -> Слоты обслуживания -->
  <line x1="350" y1="330" x2="270" y2="600" class="connection"/>
  <text x="300" y="465" class="connection-text">обслуживает</text>
  <text x="340" y="335" class="multiplicity">1</text>
  <text x="275" y="595" class="multiplicity">*</text>
  
  <!-- Услуги -> Слоты обслуживания -->
  <line x1="650" y1="465" x2="270" y2="635" class="connection"/>
  <text x="460" y="545" class="connection-text">включает</text>
  <text x="640" y="460" class="multiplicity">1</text>
  <text x="275" y="630" class="multiplicity">*</text>
  
  <!-- НОВЫЕ СВЯЗИ -->
  <!-- Клиенты -> Скидки клиенту -->
  <line x1="160" y1="330" x2="160" y2="780" class="connection-new"/>
  <text x="175" y="555" class="connection-text-new">получает скидки</text>
  <text x="140" y="335" class="multiplicity-new">1</text>
  <text x="140" y="775" class="multiplicity-new">*</text>
  
  <!-- Клиенты -> Извещение клиента -->
  <line x1="270" y1="290" x2="950" y2="640" class="connection-new"/>
  <text x="610" y="465" class="connection-text-new">получает уведомления</text>
  <text x="275" y="295" class="multiplicity-new">1</text>
  <text x="940" y="635" class="multiplicity-new">*</text>
  
  <!-- Слоты обслуживания -> Извещение клиента -->
  <line x1="270" y1="640" x2="950" y2="640" class="connection-new"/>
  <text x="610" y="635" class="connection-text-new">генерирует</text>
  <text x="275" y="635" class="multiplicity-new">1</text>
  <text x="940" y="635" class="multiplicity-new">*</text>
  
  <!-- Легенда -->
  <g id="legend">
    <rect x="950" y="60" width="300" height="250" fill="#f8f9fa" stroke="#dee2e6" stroke-width="1"/>
    <text x="960" y="80" class="attr-text" font-weight="bold">Обозначения:</text>
    <text x="960" y="100" class="attr-text pk-text">Красный цвет</text>
    <text x="1080" y="100" class="attr-text"> - Первичный ключ (PK)</text>
    <text x="960" y="115" class="attr-text fk-text">Синий курсив</text>
    <text x="1080" y="115" class="attr-text"> - Внешний ключ (FK)</text>
    <text x="960" y="130" class="attr-text" fill="#28a745" font-weight="bold">Зеленый цвет</text>
    <text x="1080" y="130" class="attr-text"> - Новые сущности</text>
    
    <text x="960" y="155" class="attr-text" font-weight="bold">Мощности связей:</text>
    <text x="960" y="170" class="attr-text">1 : 1 - один к одному</text>
    <text x="960" y="185" class="attr-text">1 : * - один ко многим</text>
    <text x="960" y="200" class="attr-text">* : * - многие ко многим</text>
    <text x="960" y="215" class="attr-text">(через промежуточную таблицу)</text>
    
    <text x="960" y="240" class="attr-text" font-weight="bold">Новые связи (зеленые):</text>
    <text x="960" y="255" class="attr-text">Клиенты → Скидки (1:*)</text>
    <text x="960" y="270" class="attr-text">Клиенты → Уведомления (1:*)</text>
    <text x="960" y="285" class="attr-text">Слоты → Уведомления (1:*)</text>
  </g>
</svg>